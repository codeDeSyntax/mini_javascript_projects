<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script>
        window.va =
            window.va ||
            function () {
                (window.vaq = window.vaq || []).push(arguments);
            };
    </script>
    <script defer src="../_vercel/speed-insights/script.js"></script>
    <script defer src="../_vercel/insights/script.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
    <link rel="shortcut icon" href="../../assets/favicon.ico" type="image/x-icon" />
    <title>DCIT 208 MOCK Quiz</title>
    <style>
        @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap");

        body {
            font-family: "Poppins", Arial, Helvetica, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 10px;
        }

        .question {
            margin-bottom: 20px;
        }

        .hint {
            height: 20px;
            width: 20px;
            position: absolute;
        }

        #hinting {
            font-size: 1.5rem;
        }

        #hinting:hover {
            cursor: pointer;
        }

        #removeHinting {
            font-size: 1.5rem;
        }

        #removeHinting:hover {
            cursor: pointer;
        }

        .result {
            font-size: 18px;
            font-weight: bold;
            margin-top: 20px;
        }

        .feedback {
            display: none;
            border: 1px solid #ccc;
            padding: 20px;
            border-radius: 8px;
            background-color: #f9f9f9;
        }

        .feedback div {
            margin-bottom: 10px;
        }

        .feedback p.correct {
            color: green;
            font-weight: bold;
        }

        .feedback p.incorrect {
            color: red;
            font-weight: bold;
        }

        .button-group {
            margin-top: 20px;
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            gap: 1rem;
        }

        #username {
            border: none;
            border-radius: 0.5rem;
            padding: 1.1rem;
            width: 80%;
            border-color: rgb(60, 101, 143);
            outline: none;
        }

        .lecturesDialog {
            z-index: 10000;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .lecturesDialog>div {
            background: white;
            padding: 4rem 4rem;
            border-radius: 10px;
            text-align: center;
        }

        #usernameDialog {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #usernameDialog>div {
            background: #2d4059;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 4rem 4rem;
            border-radius: 10px;
            text-align: center;
        }

        #authPage {
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            position: fixed;
            inset: 0;
            justify-content: center;
            align-items: center;
        }

        #authPageDiv {
            background: #2d4059;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 4rem 4rem;
            border-radius: 10px;
            text-align: center;
        }

        #feedbackChoice {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #feedbackChoice>div {
            background: #53aca8;
            padding: 8rem 8rem;
            border-radius: 10px;
            text-align: center;
            position: relative;
        }

        #scoreContainer {
            z-index: 10000;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #scoreContainer>div {
            background: #434e52;
            padding: 5rem 5rem;
            border-radius: 10px;
            text-align: center;
        }

        #start-btn {
            padding: 1.1rem 1.1rem;
            border-radius: 0.8rem;
            border-width: 0.1rem;
            background: #6643b5;
            color: white;
            font-weight: bold;
            border: none;
        }

        #see {
            padding: 1.1rem 1.1rem;
            border-radius: 0.8rem;
            border-width: 0.1rem;
            color: white;
            font-weight: bold;
            border: none;
        }

        .btn {
            padding: 0.8rem 0.8rem;
            border-radius: 0.8rem;
            border-width: 0.1rem;
            background-color: rgb(66, 137, 195);
            color: white;
            border: none;
            font-weight: bold;
        }

        .btn:disabled {
            opacity: 0.2;
        }

        .usr-score {
            font-weight: bold;
            display: flex;
            flex-direction: row;
            justify-content: start;
            align-items: start;
            gap: 0.8rem;
            color: black;
        }

        #usr-h2 {
            font-weight: bold;
            font-size: 1.6rem;
            color: white;
            margin-bottom: 0;
        }

        #auth-h2 {
            font-weight: bold;
            font-size: 1.6rem;
            color: white;
            margin-bottom: 0;
        }


        .auth-h2 {
            font-weight: bold;
            font-size: 1.6rem;
            color: #ecce6d;
            margin-bottom: 0;
        }

        #container-1 {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        #quiz-h1 {
            font-weight: bolder;
            font-size: 2rem;
            color: #01252a;
            margin-bottom: 0;
        }

        #result {
            color: green;
            font-weight: bold;
            font-size: 1.5rem;
        }

        #lectureCheckboxes {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            align-items: start;
        }

        #lectureCheckboxes {
            padding: 0.8rem 0.8rem;
            border-radius: 0.8rem;
            border-width: 0.1rem;
            background-color: rgba(30, 74, 109, 0.84);
            color: white;
            border: none;
            font-weight: bold;
        }

        .feedbackContainer {
            overflow: scroll;
            display: contents;
        }

        button {
            cursor: pointer;
        }

        #quizContainer {
            width: 85vw;
        }

        #quiz-options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 20px;
        }

        #quiz-options label {
            display: flex;
            align-items: center;
        }

        #quiz-options input[type="radio"] {
            margin-right: 10px;
        }

        #startSelectedLectures {
            margin-top: 1.2rem;
        }

        #usernameDiv {
            margin-top: 1rem;
            display: flex;
            flex-direction: row;
            justify-content: center;
            gap: 1rem;
            align-items: center;
        }

        #lectureSelection {
            margin-top: 20px;
            display: none;
            /* Initially hide lecture selection */
        }

        #lectureSelection label {
            display: block;
            margin-bottom: 10px;
        }

        .btns {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        #question-count-container {
            display: flex;
            flex-direction: row-reverse;
            justify-content: space-between;
            align-items: center;
            cursor: default;
            margin-top: 0;
            padding: 0.8rem 0.8rem;
            border-radius: 0.8rem;
            border-width: 0.1rem;
            background: #430f58;
            color: white;
            border: solid;
            font-weight: bold;
        }

        .submit {
            background: #2c2955;
        }

        .select {
            background: #6643b5;
        }

        .seeQNA {
            background: #430f58;
        }

        .green {
            background: #055049;
        }

        .start {
            background: #6643b5;
        }

        .save {
            background: #069a8e;
        }

        .next {
            background: #7cbd1e;
        }

        .back {
            background: #434e52;
        }

        #selectBox {
            background: #ecce6d;
            padding: 4rem 4rem;
        }

        .btnSize {
            padding: 1.2rem 1.6rem;
            font-size: 1.4rem;
        }

        .resetRed {
            background: #84253e;
        }

        #resetButton:disabled {
            background: #84253e71;
        }

        #showFeedOptions {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
            gap: 2rem;
        }

        #usr-h4 {
            margin-top: 0;
            font-weight: 500;
            color: rgb(217, 85, 85);
            font-size: 0.9rem;
        }

        #scoreShowContainer {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem;
        }

        .usr-h2 {
            margin-top: 0;
        }

        .logo {
            margin-bottom: 0;
        }

        #enter-btn {
            margin-top: 0.9rem;
            cursor: pointer;
            transition: all ease-out 0.14s;
            font-size: 1.4rem;
            padding: 0.8rem 0.8rem;
            border-radius: 0.8rem;
            border-width: 0.1rem;
            background-color: rgb(66, 137, 195);
            color: white;
            width: 80%;
            border: none;
            font-weight: bold;
        }

        #enter-btn:hover {
            padding: 1.1rem 1.1rem;
            background-color: #7cbd1e;
        }

        #authInput {
            margin-top: 0.9rem;
            padding: 1.2rem 1rem;
            border-radius: 0.9rem;
            border: none;
            width: 100%;
            outline: none;
            font-size: 1rem;
            text-align: center;
        }

        #authInputUsername {
            margin-top: 0.9rem;
            padding: 1.2rem 1rem;
            border-radius: 0.9rem;
            border: none;
            width: 100%;
            outline: none;
            font-size: 1rem;
            text-align: center;
        }


        #authInputUsername::placeholder {
            font-size: 1.2rem;
        }


        #authInput::placeholder {
            font-size: 1.2rem;
        }

        #loader {
            margin-top: 1rem;
            display: none;
            border: 0.5rem solid #069a8e;
            border-top: 0.5em solid #6643b5;
            border-radius: 50%;
            width: 2rem;
            height: 2rem;
            animation: spin 2s linear infinite;
        }

        #loader2 {
            margin-top: 1rem;
            display: none;
            border: 0.5rem solid #069a8e;
            border-top: 0.5em solid #6643b5;
            border-radius: 50%;
            width: 2rem;
            height: 2rem;
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .loaderContainer {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
        }
    </style>
</head>

<body>

    <div id="authPage" style="display: none;">
        <div id="authPageDiv">
            <img id="logo" src="../../assets/images/bbf-logo.svg" alt="bbf labs logo" />
            <h2 id="auth-h2" class="usr-h2">You don't have access to the page</h2>
            <h2 class="auth-h2" id="auth-key-text">Have an Auth key?</h2>
            <div id="loader"></div>
            <input id="authInputUsername" type="text" maxlength="20" placeholder="Enter username key" />
            <input id="authInput" type="password" placeholder="Enter auth key" />
            <div id="enter-btn">Enter it</div>
        </div>
    </div>
    <div id="pageContents">
        <div id="usernameDialog">
            <div>
                <img id="logo" src="../../assets/images/bbf-logo.svg" alt="bbf labs logo" />
                <h2 id="usr-h2" class="usr-h2">Choose a username</h2>
                <h4 id="usr-h4">
                    A username is required to access anything on the page
                </h4>
                <div class="loaderContainer">
                    <div id="loader2"></div>
                </div>
                <input type="text" id="username" placeholder="Username" required />
                <div id="usernameDiv">
                    <button id="start-btn" onclick="startQuiz()">Start Quiz</button>
                    <button class="btn seeQNA" id="see" onclick="showQA()">
                        See Q & A
                    </button>
                </div>
            </div>
        </div>



        <div id="lectureSelectionDialog" class="lecturesDialog" style="display: none">
            <div id="selectBox">
                <h2 id="usr-h2">Select Lectures</h2>
                <div id="lectureCheckboxes"></div>
                <button id="startSelectedLectures" class="btn start" onclick="startSelectedLectures()">
                    Start Quiz
                </button>
            </div>
        </div>

        <div id="container-1">
            <div id="scoreContainer" style="display: none">
                <div class="score-div">
                    <img id="logo" src="../../assets/images/bbf-logo.svg" alt="bbf labs logo" />
                    <p id="usr-h2">Scores</p>
                    <div id="scoreShowContainer"></div>
                    <div id="showFeedOptions">
                        <button class="btn green btnSize" id="yesButton" onclick="previousQuestionFromFeedBack()">
                            Back
                        </button>
                        <button class="btn voilet btnSize" id="noButton" onclick="retakeQuiz()">
                            Retake
                        </button>
                    </div>
                </div>
            </div>
            <div id="quizContainer" style="display: none">
                <h1 id="quiz-h1">DCIT 208 Mock Quiz: A BBF Labs Initiative</h1>
                <div id="question-count-container">
                    <div class="" style="display: flex; align-items: center; gap: 5px">
                        <!-- add hinting icon -->
                        <i class="fa-regular fa-lightbulb" id="hinting" title="Get hint with emoji expressions"></i>
                        <i class="fa-regular fa-ban" id="removeHinting" title="remove hint on this question"></i>
                        <button id="scoresBtn" class="btn next" onclick="checkScores()">
                            View Scores
                        </button>
                    </div>
                    <div id="question-count"></div>
                </div>
                <!-- <div id="quiz-options">
                <label>
                    <input type="radio" name="quizType" value="all" checked>
                    All Lectures
                </label>
                <label>
                    <input type="radio" name="quizType" value="custom">
                    Select Lectures
                </label>
            </div> -->
                <div id="lectureSelection">
                </div>
                <form id="quizForm">
                </form>
                <div class="btns">
                    <div class="button-group">
                        <div>
                            <button class="btn back" id="backButton" onclick="previousQuestion()">
                                Back
                            </button>
                            <button class="btn save" onclick="saveAnswer()">Save</button>
                            <button class="btn next" id="nextButton" onclick="nextQuestion()">
                                Next
                            </button>
                        </div>
                        <div>
                            <button class="btn seeQNA" onclick="showQA()">Q & A</button>
                            <button id="submit-btn" class="btn submit" onclick="checkAnswers()">
                                Submit
                            </button>
                        </div>
                    </div>

                    <div>
                        <button id="selectLectBtn" class="btn select" onclick="showLectureSelection()">
                            Lectures
                        </button>
                        <button class="btn resetRed" id="resetButton" onclick="resetQuiz()">
                            Reset Quiz
                        </button>
                    </div>
                </div>
                <div id="result" class="result"></div>
            </div>
            <div class="usr-score" id="user-answers"></div>

            <div id="feedbackContainer" class="feedback">
                <form id="feedbackForm">
                    <!-- Quiz questions with answers will be displayed here -->
                </form>
            </div>
            <div class="button-group" id="retakeGroup" style="display: none">
                <button class="btn backk" id="feedbackBackButton" onclick="previousQuestionFromFeedBack()">
                    Back to Quiz
                </button>
                <button class="btn next" id="feedbackNextButton" onclick="nextFeedback()">
                    Next
                </button>
                <button class="btn select" id="retakeQuizButton" onclick="retakeQuiz()">
                    Retake Quiz
                </button>
            </div>
            <div id="result2" class="result"></div>
            <div id="feedbackChoice" style="display: none">
                <div>
                    <img id="logo" src="../../assets/images/bbf-logo.svg" alt="bbf labs logo" width="70px" />
                    <p id="usr-h2" class="usr-h2" style="margin-bottom: 1rem">
                        Show feedback?
                    </p>
                    <div id="showFeedOptions">
                        <button class="btn green btnSize" id="yesButton" onclick="showFeedback()">
                            Yes
                        </button>
                        <button class="btn voilet btnSize" id="noButton" onclick="hideFeedback()">
                            No
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let questions = [
            {
                question: "What is the primary focus of agile development methods?",
                options: [
                    "A. Increasing documentation.",
                    "B. Reducing delivery time for working software.",
                    "C. Emphasizing design over code.",
                    "D.  Following a strict, pre-defined plan."
                ],
                answer: "B"
            },
            {
                question: "Which of the following is a characteristic of plan-driven software development?",
                options: [
                    "A.  Development stages are interleaved.",
                    "B. Minimal documentation is produced.",
                    "C.  Outputs for each stage are planned in advance.",
                    "D. Stakeholders are primarily involved in the final evaluation."
                ],
                answer: "C"
            },
            {
                question: "What is the role of stakeholders in agile development?",
                options: [
                    "A. They are primarily involved in version specification and evaluation.",
                    "B. They are responsible for defining the overall project plan.",
                    "C. They have limited involvement, primarily in the initial stages.",
                    "D. They are not involved in the development process."
                ],
                answer: "A"
            },
            {
                question: "What is a key difference between plan-driven and agile development regarding documentation?",
                options: [
                    "A. Plan-driven development emphasizes extensive documentation, while agile development minimizes it.",
                    "B. Agile development emphasizes extensive documentation, while plan-driven development minimizes it.",
                    "C. Both approaches prioritize extensive documentation.",
                    "D. Neither approach uses documentation."
                ],
                answer: "A"
            },
            {
                question: "What is the primary driver behind the need for rapid software development and delivery?",
                options: [
                    "A. Technological advancements.",
                    "B. Fast-changing business requirements.",
                    "C. Increased competition in the software industry.",
                    "D.  Shorter product lifecycles."
                ],
                answer: "B"
            },
            {
                question: "Which statement best describes the agile development approach?",
                options: [
                    "A. Specification, design, implementation, and testing are performed sequentially.",
                    "B. Specification, design, implementation, and testing are interleaved and negotiated throughout development.",
                    "C. A detailed plan is created upfront and strictly followed throughout development.",
                    "D. Documentation is the primary focus of agile development."
                ],
                answer: "B"
            },
            {
                question: "Which of the following is NOT a core principle of agile methods?",
                options: [
                    "A. Customer involvement.",
                    "B.  Incremental delivery.",
                    "C. Extensive documentation.",
                    "D.  Embrace change."
                ],
                answer: "C"
            },
            {
                question: "In agile development, what does \"embracing change\" mean?",
                options: [
                    "A.  Avoiding changes to the initial requirements.",
                    "B. Designing the system to accommodate changing requirements.",
                    "C. Having a rigid development process that resists change.",
                    "D.  Ignoring new requirements that emerge after development starts."
                ],
                answer: "B"
            },
            {
                question: "What is the main goal of agile methods regarding overheads?",
                options: [
                    "A.  To increase documentation to improve traceability.",
                    "B. To reduce overheads to be able to respond quickly to changing requirements.",
                    "C.  To eliminate all overheads to maximize development speed.",
                    "D. To add more overheads to ensure software quality."
                ],
                answer: "B"
            },
            {
                question: "What is the recommended approach to software development in situations with both plan-driven and agile elements?",
                options: [
                    "A.  Always choose plan-driven development.",
                    "B.  Always choose agile development.",
                    "C.  Decide on the balance based on technical, human, and organizational issues.",
                    "D. Combine both approaches in equal measure for all projects."
                ],
                answer: "C"
            },
            {
                question: "What decade saw the emergence of agile development methods?",
                options: [
                    "A. 1970s",
                    "B. 1980s",
                    "C. 1990s",
                    "D. 2000s"
                ],
                answer: "C"
            },
            {
                question: "According to the Agile Manifesto, what is valued more than processes and tools?",
                options: [
                    "A.  Comprehensive documentation.",
                    "B. Individuals and interactions.",
                    "C.  Contract negotiation.",
                    "D. Following a plan."
                ],
                answer: "B"
            },
            {
                question: "Which of the following is NOT a principle emphasized in the Agile Manifesto?",
                options: [
                    "A. Working software over comprehensive documentation.",
                    "B. Customer collaboration over contract negotiation.",
                    "C. Processes and tools over individuals and interactions.",
                    "D.  Responding to change over following a plan."
                ],
                answer: "C"
            },
            {
                question: "What is the customer's primary role in agile development?",
                options: [
                    "A.  To define the technical architecture of the system.",
                    "B. To provide and prioritize new system requirements and evaluate iterations.",
                    "C.  To manage the daily activities of the development team.",
                    "D.  To write the code for the system."
                ],
                answer: "B"
            },
            {
                question: "How is software delivered in an agile development process?",
                options: [
                    "A.  As a single, complete product at the end of the development cycle.",
                    "B. In increments, with the customer specifying requirements for each increment.",
                    "C. In a series of prototypes, with no fixed delivery schedule.",
                    "D. In parallel with multiple teams working independently."
                ],
                answer: "B"
            },
            {
                question: "What does the principle \"people not process\" mean in agile development?",
                options: [
                    "A.  Ignoring individual skills and enforcing strict processes.",
                    "B. Recognizing and exploiting the skills of the development team, allowing them to define their working ways.",
                    "C.  Prioritizing automated processes over human input.",
                    "D.  Minimizing communication and collaboration within the team."
                ],
                answer: "B"
            },
            {
                question: "How does the agile principle of \"maintain simplicity\" manifest?",
                options: [
                    "A.  By adding complex features to the software.",
                    "B.  By focusing on simplicity in the software and the development process.",
                    "C.  By avoiding refactoring of code to prevent introducing errors.",
                    "D.  By relying heavily on documentation to explain the system."
                ],
                answer: "B"
            },
            {
                question: "Which of the following is a challenge in applying agile methods to large systems?",
                options: [
                    "A. The focus on small, tightly-integrated teams.",
                    "B. The emphasis on customer involvement.",
                    "C. The iterative nature of agile development.",
                    "D. The minimal documentation approach."
                ],
                answer: "A"
            },
            {
                question: "What is a potential problem with maintaining customer interest in agile development?",
                options: [
                    "A.  Customers may lose interest due to the intense involvement required.",
                    "B.  Customers may be overwhelmed by the frequent delivery of new increments.",
                    "C.  Customers may not understand the technical details of the development process.",
                    "D.  Customers may be satisfied with the initial prototype and not see the need for further iterations."
                ],
                answer: "A"
            },
            {
                question: "Why can prioritizing changes be difficult in agile development with multiple stakeholders?",
                options: [
                    "A.  Stakeholders may have different priorities and conflicting requirements.",
                    "B.  Agile development does not allow for changes to requirements once development has started.",
                    "C.  Prioritization is not a concept considered in agile development.",
                    "D.  Multiple stakeholders always agree on priorities, making the process straightforward."
                ],
                answer: "A"
            },
            {
                question: "Which of the following is a common problem with contracts in iterative development approaches like agile?",
                options: [
                    "A.  Contracts are typically very flexible and easy to adapt to changing requirements.",
                    "B.  Agile development does not use contracts.",
                    "C. Contracts may be difficult to define upfront due to the evolving nature of requirements in iterative development.",
                    "D.  Contracts are not necessary in agile development because of the close customer collaboration."
                ],
                answer: "C"
            },
            {
                question: "What is the frequency of new software versions being built in Extreme Programming (XP)?",
                options: [
                    "A.  Several times per day.",
                    "B. Once a week.",
                    "C.  Once a month.",
                    "D. Once every two weeks."
                ],
                answer: "A"
            },
            {
                question: "How often are increments delivered to customers in Extreme Programming (XP)?",
                options: [
                    "A. Daily.",
                    "B. Weekly.",
                    "C. Every two weeks.",
                    "D.  Monthly."
                ],
                answer: "C"
            },
            {
                question: "When is a software build considered accepted in Extreme Programming (XP)?",
                options: [
                    "A.  When the code compiles successfully.",
                    "B. When the developers decide it is ready.",
                    "C.  When all tests run successfully.",
                    "D. When the customer approves the design."
                ],
                answer: "C"
            },
            {
                question: "How does Extreme Programming (XP) support the agile principle of 'customer involvement'?",
                options: [
                    "A.  By having a full-time customer engagement with the development team.",
                    "B. By limiting customer involvement to the initial requirements gathering stage.",
                    "C.  By having the customer write the code for the system.",
                    "D.  By excluding the customer from the testing process."
                ],
                answer: "A"
            },
            {
                question: "What practices in Extreme Programming (XP) support the agile principle of 'people not process'?",
                options: [
                    "A.  Pair programming, collective ownership, and avoiding long working hours.",
                    "B.  Extensive documentation, individual coding, and strict adherence to plans.",
                    "C.  Automated testing, outsourced development, and limited customer interaction.",
                    "D.  Waterfall development model, formal code inspections, and centralized decision-making."
                ],
                answer: "A"
            },
            {
                question: "How is the agile principle of 'maintaining simplicity' supported in Extreme Programming (XP)?",
                options: [
                    "A.  Through constant refactoring of code.",
                    "B.  By avoiding code changes after the initial implementation.",
                    "C.  By adding complex features to the software to anticipate future needs.",
                    "D.  Through extensive documentation to explain the system's intricacies."
                ],
                answer: "A"
            },
            {
                question: "Why is Extreme Programming (XP) not easily integrated into management practices in some organizations?",
                options: [
                    "A.  Its technical focus may not align with management's broader business concerns.",
                    "B. It requires significant changes to organizational structure and culture.",
                    "C.  It is too complex for most managers to understand.",
                    "D.  It lacks defined roles and responsibilities."
                ],
                answer: "A"
            },
            {
                question: "What are \"user stories\" in Extreme Programming (XP)?",
                options: [
                    "A. Detailed technical specifications of the system's functionality.",
                    "B. User requirements expressed as scenarios written on cards.",
                    "C. Formal test cases used to validate the system.",
                    "D.  Documentation of the system's design and architecture."
                ],
                answer: "B"
            },
            {
                question: "How are \"user stories\" used in Extreme Programming (XP)?",
                options: [
                    "A.  They are used for documentation purposes only.",
                    "B.  They are used as the basis for schedule and cost estimates and to guide development.",
                    "C.  They are written by the development team and handed over to the customer for approval.",
                    "D.  They are only used in the initial stages of the project."
                ],
                answer: "B"
            },
            {
                question: "What is \"refactoring\" in Extreme Programming (XP)?",
                options: [
                    "A.  Rewriting the entire codebase from scratch.",
                    "B.  A process of constantly improving the code to make changes easier.",
                    "C.  Adding new features to the software without changing existing code.",
                    "D.  A testing technique used to identify and fix defects."
                ],
                answer: "B"
            },
            {
                question: "How does refactoring in Extreme Programming (XP) impact documentation?",
                options: [
                    "A.  It increases the need for documentation because the code is constantly changing.",
                    "B.  It has no impact on documentation needs.",
                    "C. It reduces the need for documentation because well-structured code is easier to understand.",
                    "D.  It eliminates the need for documentation entirely."
                ],
                answer: "C"
            },
            {
                question: "Which testing approach is central to Extreme Programming (XP)?",
                options: [
                    "A.  Testing at the end of the development cycle.",
                    "B.  Test-driven development, where tests are written before the code.",
                    "C.  Manual testing performed by end-users.",
                    "D.  Testing only the new functionality added in each iteration."
                ],
                answer: "B"
            },
            {
                question: "What is the role of the customer in the testing process in Extreme Programming (XP)?",
                options: [
                    "A.  The customer is not involved in the testing process.",
                    "B. The customer helps develop acceptance tests for the user stories.",
                    "C.  The customer is responsible for writing all the test code.",
                    "D.  The customer approves the test cases before they are executed."
                ],
                answer: "B"
            },
            {
                question: "Why might some individuals adopting the customer role in Extreme Programming (XP) be hesitant to participate in the testing process?",
                options: [
                    "A.  They may have limited time and feel their primary contribution was providing the initial requirements.",
                    "B. They may not have the technical skills to participate in testing.",
                    "C.  They may not understand the importance of testing.",
                    "D.  They may feel that testing is the responsibility of the development team."
                ],
                answer: "A"
            },
            {
                question: "How does pair programming in Extreme Programming (XP) mitigate risks associated with team members leaving the project?",
                options: [
                    "A.  It ensures that there is always a backup developer who can take over the work.",
                    "B. It promotes knowledge sharing, reducing reliance on individual team members.",
                    "C. It enforces strict coding standards, making it easier for new team members to understand the code.",
                    "D.  It has no impact on risks associated with team member turnover."
                ],
                answer: "B"
            }
        ]
        let ses1 = { start: 0, end: 35, name: "Session 1" };

        const lectureRanges = [ses1];
        let currentQuestion = 0;
        let userAnswers = Array(questions.length).fill("");
        let selectedQuestions = [];
        let quizType = "all";

        const baseUrl = "https://bbf-backend.onrender.com/api/quiz/user/";
        const usernameDialog = document.getElementById("usernameDialog");
        const quizContainer = document.getElementById("quizContainer");
        const quizOptionsDiv = document.getElementById("quiz-options");
        const lectureSelectionDiv = document.getElementById("lectureSelection");
        const quizForm = document.getElementById("quizForm");
        const feedbackContainer = document.getElementById("feedbackContainer");
        const feedbackChoice = document.getElementById("feedbackChoice");
        const resultDiv = document.getElementById("result");
        const resultDiv2 = document.getElementById("result2");
        const sectionTitle = document.getElementById("quiz-h1");
        const retake = document.getElementById("retakeGroup");
        const userScore = document.getElementById("user-answers");
        const scoreContainer = document.getElementById("scoreContainer");
        const resetBtn = document.getElementById("resetButton");
        const questionCountSpan = document.getElementById("question-count");
        const questionCountContainer = document.getElementById(
            "question-count-container"
        );
        let userName = "" || localStorage.getItem("username");
        const usernameInput = (document.getElementById("username").value = userName);

        const enterBtn = document.getElementById("enter-btn");
        const loader = document.getElementById("loader");
        const loader2 = document.getElementById("loader2");
        const authInput = document.getElementById("authInput");
        const authUsername = document.getElementById("authInputUsername");
        const authHeader = document.getElementById("auth-h2");
        const authKeyText = document.getElementById("auth-key-text");
        const authDiv = document.getElementById("authPage");
        let authKey = "";
        const pageContents = document.getElementById("pageContents");

        validateUserOnLoad();

        async function validateUserFromAPI() {
            try {
                userName = authUsername.value.trim().toLowerCase();
                localStorage.setItem("username", userName);
                authKey = authInput.value.trim();

                let payload = JSON.stringify({
                    username: userName,
                    key: authKey,
                });

                authKeyText.innerText = "Validating Auth Key";
                authHeader.innerText = "";
                authInput.style.display = "none";
                authUsername.style.display = "none";
                enterBtn.style.display = "none";
                loader.style.display = "block";

                const response = await fetch(
                    "https://bbf-backend.onrender.com/api/quiz/user/verify",
                    {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: payload,
                        mode: "cors",
                    }
                );

                if (!response.ok) {
                    throw new Error("Authentication Error");
                }

                const data = await response.json();

                if (data.isValid) {
                    authKeyText.innerText = "Auth Key Validated!";
                    authHeader.innerText = "Redirecting...";
                    localStorage.setItem(
                        "authStatus",
                        JSON.stringify({ username: userName, isAuthenticated: true })
                    );
                    setTimeout(() => {
                        localStorage.setItem("authUser", userName);
                        authDiv.style.display = "none";
                        pageContents.style.display = "block";
                        loader2.style.display = "none";
                        document.getElementById("username").value = userName;
                        startQuiz();
                    }, 1000);
                } else {
                    authKeyText.innerText = "Invalid Auth Key!";
                    authInput.value = "";
                    authHeader.innerText = "Invalid Auth Key";
                }
            } catch (error) {
                console.error("Fetch error:", error);
                authHeader.innerText = error.message;
                authKeyText.innerText = "Have an auth key?";
                authHeader.style.display = "block";
                authInput.style.display = "block";
                authUsername.style.display = "block";
                enterBtn.style.display = "block";
                loader.style.display = "none";
            }
        }

        enterBtn.addEventListener("click", () => {
            if (authInput.value.trim() === "") {
                alert("Please enter your auth key");
                return;
            }
            validateUserFromAPI();
        });

        function saveScore(score) {
            let scores = JSON.parse(localStorage.getItem("scores")) || [];
            scores.push({ username: userName, score: score });
            localStorage.setItem("scores", JSON.stringify(scores));
        }

        function startQuiz() {
            const usernameInput = document.getElementById("username");
            let username = usernameInput.value.trim();

            if (username === "") {
                if (localStorage.getItem("username")) {
                    username = localStorage.getItem("username");
                    userName = username;
                    usernameInput.value = username;
                    validateUserOnLoad();
                } else {
                    alert("Please enter a username");
                    return;
                }
            } else {
                localStorage.setItem("username", username);
                userName = username;
            }

            const localStat = JSON.parse(localStorage.getItem("authStatus"));
            if (localStat.username === username && localStat.isAuthenticated !== !1) {
                pageContents.style.display = "block";
                authDiv.style.display = "none";
            } else {
                pageContents.style.display = "none";
                authDiv.style.display = "flex";
                return;
            }

            validateUserOnLoad();

            if (
                username === localStorage.getItem("previousUser") &&
                localStorage.getItem("currentQuestion") !== "" &&
                JSON.parse(localStorage.getItem("userAnswers")).length > 0 &&
                JSON.parse(localStorage.getItem("selectedQuestions")).length > 0
            ) {
                userAnswers = JSON.parse(localStorage.getItem("userAnswers"));
                currentQuestion = parseInt(localStorage.getItem("currentQuestion"));
                selectedQuestions = JSON.parse(localStorage.getItem("selectedQuestions"));
                usernameDialog.style.display = "none";
                quizContainer.style.display = "block";
                showQuestion(currentQuestion);
            } else {
                userAnswers = Array(questions.length).fill("");
                currentQuestion = 0;
                selectedQuestions = [];
                generateLectureSelection();
                usernameDialog.style.display = "none";
                quizContainer.style.display = "block";
                updateQuiz();
            }
        }

        async function validateUserOnLoad() {
            const usernameValue = document.getElementById("username").value.trim();
            const uDiv = document.getElementById("username");
            const uBtnFiv = document.getElementById("usernameDiv");
            const localStat = JSON.parse(localStorage.getItem("authStatus"));
            uDiv.addEventListener("input", () => {
                setTimeout(() => {
                    loader2.style.display = "block";
                    uDiv.style.display = "none";
                    uBtnFiv.style.display = "none";
                }, 10000);
            });
            setTimeout(() => {
                loader2.style.display = "none";
                uDiv.style.display = "block";
                uBtnFiv.style.display = "flex";
            }, 10000);

            if (!localStat) {
                setTimeout(() => {
                    loader2.style.display = "none";
                    uDiv.style.display = "block";
                    uBtnFiv.style.display = "flex";
                }, 1000);
                localStorage.setItem(
                    "authStatus",
                    JSON.stringify({ username: usernameValue, isAuthenticated: false })
                );
                uDiv.style.display = "block";
                uBtnFiv.style.display = "flex";
                pageContents.style.display = "none";
                authDiv.style.display = "flex";
                return;
            }
            if (localStat.username === usernameValue && localStat.isAuthenticated) {
                return;
            } else {
                document.getElementById("username").value = "";
                usernameValue =
                    document.getElementById("username").value.trim() ||
                    localStorage.getItem("username");
                uDiv.style.display = "none";
                uBtnFiv.style.display = "none";
                loader2.style.display = "block";
                try {
                    const response = await fetch(
                        `https://bbf-backend.onrender.com/api/quiz/user/validate/${usernameValue}`,
                        {
                            method: "GET",
                            headers: {
                                "Content-Type": "application/json",
                            },
                            mode: "cors",
                        }
                    );

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const data = await response.json();
                    setTimeout(() => {
                        loader2.style.display = "none";
                        uDiv.style.display = "block";
                        uBtnFiv.style.display = "flex";
                    }, 1000);

                    if (!data.isValid) {
                        pageContents.style.display = "none";
                        authDiv.style.display = "flex";

                        localStorage.setItem(
                            "authStatus",
                            JSON.stringify({ username: usernameValue, isAuthenticated: false })
                        );
                    } else {
                        localStorage.setItem(
                            "authStatus",
                            JSON.stringify({ username: usernameValue, isAuthenticated: true })
                        );
                        uDiv.style.display = "block";
                        uBtnFiv.style.display = "flex";
                        pageContents.style.display = "block";
                        authDiv.style.display = "none";
                        return;
                    }
                } catch (error) {
                    return;
                }
            }
        }

        if (
            JSON.parse(localStorage.getItem("authStatus")).isAuthenticated !== !undefined
        ) {
            const usernameValue = document.getElementById("username").value.trim();
            const authDiv = document.getElementById("authPage");
            if (usernameValue !== JSON.parse(localStorage.getItem("authStatus")).username) {
                pageContents.style.display = "none";
                authDiv.style.display = "flex";
            }
        }

        function generateLectureSelection() {
            lectureSelectionDiv.innerHTML = "";

            lectureRanges.forEach((lectureRange, index) => {
                const label = document.createElement("label");
                label.innerHTML = `
                        <input type="checkbox" name="lectureCheckbox" value="${index + 1
                    }"> Lecture ${index + 1}
                    `;

                if (index === 6) {
                    const label = document.createElement("label");
                    label.innerHTML = `
                        <input type="checkbox" name="lectureCheckbox" value="${index + 1
                        }"> All
                    `;
                }
                lectureSelectionDiv.appendChild(label);
            });
        }

        function updateQuiz() {
            selectedQuestions = [];
            currentQuestion = 0;

            if (quizType === "custom") {
                const selectedLectureNumbers = Array.from(
                    document.querySelectorAll('input[name="lectureCheckbox"]:checked')
                ).map((checkbox) => parseInt(checkbox.value));

                if (selectedLectureNumbers.length === 0) {
                    alert("Please select at least one lecture.");
                    return;
                }

                selectedLectureNumbers.forEach((lectureNumber) => {
                    const lectureRange = getLectureRangeByNumber(lectureNumber);
                    for (let i = lectureRange.start; i <= lectureRange.end; i++) {
                        selectedQuestions.push(i);
                    }
                });

                currentQuestion = document
                    .querySelectorAll('input[name="lectureCheckbox"]:checked')
                    .map((checkbox) => parseInt(checkbox.value))[0];
            } else {
                selectedQuestions = questions.map((_, index) => index);
            }
            updateQuestionCount();
            showQuestion(currentQuestion);
        }

        function getLectureRangeByNumber(number) {
            return lectureRanges[number - 1];
        }

        function updateQuestionCount() {
            questionCountContainer.style.background = "#430f58";
            questionCountSpan.style.color = "white";
            questionCountSpan.textContent = `Question ${currentQuestion + 1} out of ${selectedQuestions.length
                }`;
        }

        function showQuestion(index) {
            quizForm.innerHTML = "";
            const questionIndex = selectedQuestions[index];
            const question = questions[questionIndex];
            const questionDiv = document.createElement("div");
            questionDiv.classList.add("question");

            const questionTitle = document.createElement("p");
            questionTitle.style.fontSize = "1rem";
            questionTitle.innerHTML = question.question;

            questionTitle.style.fontWeight = "500";
            questionTitle.style.fontSize = "1.2rem";

            questionDiv.appendChild(questionTitle);
            if (question.options.length === 1) {
                // Create an input field for the fill-in-the-blank question
                const fillInInput = document.createElement("input");
                fillInInput.type = "text";
                fillInInput.style.border = "none";
                fillInInput.style.borderBottom = "1px solid #430f58";
                fillInInput.style.outline = "none";
                fillInInput.style.fontSize = "1rem";
                fillInInput.name = "q" + (index + 1);
                fillInInput.value = userAnswers[questionIndex] || "";

                fillInInput.addEventListener("input", () => {
                    console.log("input at fill in");
                    userAnswers[questionIndex] = fillInInput.value.toLocaleLowerCase();
                    saveProgressLocally();
                });

                questionDiv.appendChild(fillInInput);
            } else {
                question.options.forEach((option) => {
                    const optionLabel = document.createElement("label");
                    const optionInput = document.createElement("input");
                    const optionHint = document.createElement("img");

                    optionInput.type = "radio";
                    optionInput.name = "q" + (index + 1);
                    optionInput.value = option[0];

                    optionHint.classList.add("hint");
                    optionHint.style.display = "none";
                    const correctEmoji =
                        "https://fonts.gstatic.com/s/e/notoemoji/latest/1f601/512.webp";
                    const incorrectEmoji =
                        "https://fonts.gstatic.com/s/e/notoemoji/latest/1f9d0/512.webp";

                    optionHint.src =
                        optionInput.value === questions[questionIndex].answer
                            ? correctEmoji
                            : incorrectEmoji;
                    optionHint.alt =
                        optionInput.value === questions[questionIndex].answer
                            ? "correct"
                            : "incorrect";

                    if (userAnswers[questionIndex] === option[0]) {
                        optionInput.checked = true;
                    }

                    optionLabel.appendChild(optionInput);
                    optionLabel.appendChild(document.createTextNode(option));

                    hinting.addEventListener("click", () => {
                        optionLabel.appendChild(optionHint);
                    });

                    removeHinting.addEventListener("click", () => {
                        optionLabel.removeChild(optionHint);
                    });

                    optionLabel.addEventListener("mouseover", () => {
                        optionHint.style.display = "inline-block";
                    });

                    optionLabel.addEventListener("mouseout", () => {
                        optionHint.style.display = "none";
                    });
                    questionDiv.appendChild(optionLabel);
                    optionLabel.addEventListener("click", () => {
                        userAnswers[questionIndex] = option[0];
                        disableResetAfterCheckboxPress();
                        saveProgressLocally();
                    });
                    questionDiv.appendChild(document.createElement("br"));
                });
            }

            quizForm.appendChild(questionDiv);

            document.getElementById("backButton").disabled = index === 0;
            document.getElementById("nextButton").disabled =
                index === selectedQuestions.length - 1;
            updateQuestionCount();
        }

        function previousQuestion() {
            saveAnswer();
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion(currentQuestion);
            }
            saveProgressLocally();
        }

        function previousQuestionFromFeedBack() {
            hideFeedback();
            scoreContainer.style.display = "none";
            function start() {
                retake.style.display = "none";
                showQuestion(currentQuestion);
            }
            start();
            retake.style.display = "none";
            resultDiv.style.display = "none";
            resultDiv2.style.display = "none";
            userScore.style.display = "none";
        }

        function saveProgressLocally() {
            localStorage.setItem("userAnswers", JSON.stringify(userAnswers));
            localStorage.setItem("currentQuestion", currentQuestion);
            localStorage.setItem("selectedQuestions", JSON.stringify(selectedQuestions));
        }

        function saveAnswer() {
            const selectedOption = document.querySelector(
                'input[name="q' + (currentQuestion + 1) + '"]:checked'
            );
            if (selectedOption) {
                userAnswers[currentQuestion] = selectedOption.value;
            }
            saveProgressLocally();
        }

        window.addEventListener("beforeunload", () => {
            localStorage.setItem("previousUser", userName);
            saveProgressLocally();
            const lastUser = localStorage.getItem("authUser");
            localStorage.setItem(
                "authStatus",
                JSON.stringify({ username: lastUser, isAuthenticated: true })
            );
        });

        function checkAnswers() {
            saveAnswer();
            let score = 0;
            let answeredQuestions = 0;

            selectedQuestions.forEach((questionIndex) => {
                if (userAnswers[questionIndex] !== "") {
                    answeredQuestions++;
                    if (
                        userAnswers[questionIndex] === questions[questionIndex].answer ||
                        userAnswers[questionIndex]
                            .toLowerCase()
                            .includes(questions[questionIndex].answer.toLowerCase())
                    ) {
                        score++;
                    }
                }
            });

            const percentage = (score / answeredQuestions) * 100;

            const capitalizedUsername = userName[0].toUpperCase() + userName.slice(1);

            //resultDiv.innerHTML = `<p>${capitalizedUsername}, you got ${score} out of ${answeredQuestions} correct! That's <span style="color: ${percentage >= 80 ? "green" : percentage <= 50 ? "yellow" : "red"};">${percentage.toFixed(2)}%</span></p>`;

            document.getElementById("quizContainer").style.display = "none";
            feedbackChoice.style.display = "contents";
        }

        function checkScores() {
            let scores = JSON.parse(localStorage.getItem("scores")) || [];

            if (!scores || scores.length === 0) {
                alert("You must complete a quiz first to view scores");
                return;
            }
            scoreContainer.style.display = "flex";
            scores.sort((a, b) => b.score - a.score);
            let scoreList = document.getElementById("scoreShowContainer");
            scoreList.innerHTML = "";
            const table = document.createElement("table");
            const thead = document.createElement("thead");
            const tbody = document.createElement("tbody");

            // Create header row
            const headerRow = document.createElement("tr");
            const headers = ["Quiz", "Score"];
            headers.forEach((headerText) => {
                const th = document.createElement("th");
                th.textContent = headerText;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);

            scores.forEach((score, index) => {
                const tr = document.createElement("tr");

                const rankCell = document.createElement("td");
                rankCell.textContent = index + 1;
                tr.appendChild(rankCell);

                const scoreCell = document.createElement("td");
                scoreCell.textContent = `${score.score.toFixed(0)}%`;
                tr.appendChild(scoreCell);

                tr.style.border = "1px solid black";
                tr.style.textAlign = "center";
                tr.style.padding = "0.7rem";
                tbody.appendChild(tr);
            });

            table.appendChild(tbody);
            table.style.border = "1px solid white";
            table.style.borderRadius = "10px";
            table.style.textAlign = "center";
            table.style.margin = "auto";
            table.style.backgroundColor = "#430f58";
            table.style.padding = "0.7rem";
            table.style.color = "white";
            scoreList.style.overflow = "auto";
            table.style.marginTop = "1rem";
            scoreList.appendChild(table);
        }

        function showFeedback() {
            retake.style.display = "block";
            retake.style.position = "relative";
            retake.style.bottom = "0";
            userScore.style.display = "flex";
            resultDiv2.style.display = "block";
            resultDiv2.style.position = "relative";
            resultDiv2.style.top = "0";
            resultDiv.style.color = "green";
            feedbackChoice.style.display = "none";
            feedbackContainer.style.display = "block";
            feedbackContainer.style.overflow = "scroll";
            let score = 0;
            let answeredQuestions = 0;

            selectedQuestions.forEach((questionIndex) => {
                if (userAnswers[questionIndex] !== "") {
                    answeredQuestions++;
                    if (
                        userAnswers[questionIndex] === questions[questionIndex].answer ||
                        userAnswers[questionIndex]
                            .toLowerCase()
                            .includes(questions[questionIndex].answer.toLowerCase())
                    ) {
                        score++;
                    }
                }
            });

            const percentage = (score / answeredQuestions) * 100 || 0;

            if (answeredQuestions === selectedQuestions.length) {
                saveScore(percentage);
            }

            const capitalizedUsername = userName[0].toUpperCase() + userName.slice(1);
            userScore.innerHTML = `<p>${capitalizedUsername}'s Score: <span style="color: ${percentage >= 80 ? "green" : percentage <= 50 ? "red" : "#bbdc2f"
                };">${percentage.toFixed(
                    0
                )}%</span></p> <p>Done: ${answeredQuestions}</p> <p>Ans: ${score}/${selectedQuestions.length
                }</p>`;

            displayFeedback();
        }

        function showQA() {
            const username = document.getElementById("username").value;
            if (username.trim() === "") {
                alert("Please enter a username");
                return;
            }
            userName = username;
            retake.style.display = "block";
            retake.style.position = "relative";
            retake.style.bottom = "0";
            feedbackChoice.style.display = "none";
            feedbackContainer.style.display = "block";
            feedbackContainer.style.overflow = "scroll";
            function displayQA() {
                feedbackContainer.style.overflow = "scroll";
                feedbackContainer.innerHTML = "";

                questions.forEach((q, index) => {
                    const questionDiv = document.createElement("div");
                    questionDiv.classList.add("question");

                    const questionTitle = document.createElement("p");
                    questionTitle.innerHTML = index + 1 + ". " + q.question;
                    questionDiv.appendChild(questionTitle);

                    // Check if the question is a fill-in-the-blank type (only one option)
                    if (q.options.length === 1) {
                        const correctAnswer = q.answer;

                        const correctAnswerParagraph = document.createElement("p");
                        correctAnswerParagraph.innerHTML = `Answer: ${correctAnswer}`;
                        correctAnswerParagraph.style.color = "green";
                        correctAnswerParagraph.style.fontWeight = "bold";
                        correctAnswerParagraph.style.marginTop = "0.5rem";
                        questionDiv.appendChild(correctAnswerParagraph);
                    } else {
                        // Existing logic for multiple-choice questions
                        q.options.forEach((option) => {
                            const optionLabel = document.createElement("label");
                            const optionInput = document.createElement("input");
                            optionInput.type = "radio";
                            optionInput.disabled = true;

                            if (option[0] === q.answer) {
                                optionInput.checked = true;
                                optionLabel.style.color = "green";
                                optionLabel.style.fontWeight = "bold";
                            }

                            optionLabel.appendChild(optionInput);
                            optionLabel.appendChild(document.createTextNode(option));
                            questionDiv.appendChild(optionLabel);
                            questionDiv.appendChild(document.createElement("br"));
                        });
                    }

                    feedbackContainer.appendChild(questionDiv);
                });

                document.getElementById("feedbackNextButton").disabled =
                    currentQuestion === questions.length - 1;
            }

            document.getElementById("quizContainer").style.display = "none";
            document.getElementById("usernameDialog").style.display = "none";
            displayQA();
            currentQuestion = 0;
            document.getElementById("feedbackNextButton").style.display = "none";
            document.getElementById("retakeQuizButton").textContent = "Start Quiz";
        }

        function showQuestionSpanChange() {
            let score = 0;
            let answeredQuestions = 0;

            selectedQuestions.forEach((questionIndex) => {
                if (userAnswers[questionIndex] !== "") {
                    answeredQuestions++;
                    if (
                        userAnswers[questionIndex] === questions[questionIndex].answer ||
                        userAnswers[questionIndex]
                            .toLowerCase()
                            .includes(questions[questionIndex].answer.toLowerCase())
                    ) {
                        score++;
                    }
                }
            });

            const percentage = (score / answeredQuestions) * 100 || 0;

            questionCountContainer.style.background = "#434e52";
            questionCountSpan.textContent = `Score: ${percentage.toFixed(0)}%`;
            questionCountSpan.style.color =
                percentage >= 80 ? "green" : percentage <= 50 ? "red" : "#bbdc2f";

            setTimeout(() => {
                updateQuestionCount();
            }, 1000);
        }

        function hideFeedback() {
            let score = 0;
            let answeredQuestions = 0;

            selectedQuestions.forEach((questionIndex) => {
                if (userAnswers[questionIndex] !== "") {
                    answeredQuestions++;
                    if (
                        userAnswers[questionIndex] === questions[questionIndex].answer ||
                        userAnswers[questionIndex]
                            .toLowerCase()
                            .includes(questions[questionIndex].answer.toLowerCase())
                    ) {
                        score++;
                    }
                }
            });

            const percentage = (score / answeredQuestions) * 100 || 0;

            const capitalizedUsername = userName[0].toUpperCase() + userName.slice(1);

            //resultDiv.innerHTML = `<p>${capitalizedUsername}, you got ${score} out of ${answeredQuestions} correct! That's <span style="color: ${percentage >= 80 ? "green" : percentage <= 50 ? "yellow" : "red"};">${percentage.toFixed(2)}%</span>... ${selectedQuestions.length - currentQuestion - 1} remain</p>`;

            feedbackChoice.style.display = "none";
            feedbackContainer.style.display = "none";
            document.getElementById("quizContainer").style.display = "block";

            showQuestion(currentQuestion);
            showQuestionSpanChange();
        }

        document.addEventListener("keydown", (event) => {
            if (event.key === "s" || event.key === "S") {
                showQuestionSpanChange();
            }
        });

        function nextQuestion() {
            saveAnswer();
            if (currentQuestion < selectedQuestions.length - 1) {
                currentQuestion++;
                showQuestion(currentQuestion);
            }
            saveProgressLocally();
        }

        function displayFeedback() {
            feedbackContainer.style.overflow = "scroll";
            feedbackContainer.innerHTML = "";

            let questionsCount = currentQuestion;
            selectedQuestions
                .slice(0, questionsCount + 1)
                .forEach((questionIndex, index) => {
                    const q = questions[questionIndex];
                    const questionDiv = document.createElement("div");
                    questionDiv.classList.add("question");

                    const questionTitle = document.createElement("p");
                    questionTitle.innerHTML = index + 1 + ". " + q.question;
                    questionDiv.appendChild(questionTitle);

                    q.options.forEach((option) => {
                        // Check if the question is a fill-in-the-blank type
                        if (q.options.length === 1) {
                            const userAnswer = userAnswers[questionIndex];
                            const correctAnswer = q.answer.toLowerCase();

                            const feedbackParagraph = document.createElement("p");
                            feedbackParagraph.innerHTML =
                                "Your Answer: " + (userAnswer || "No answer given");

                            if (
                                userAnswer.toLowerCase().includes(correctAnswer.toLowerCase()) &&
                                userAnswer !== ""
                            ) {
                                feedbackParagraph.style.color = "green";
                                feedbackParagraph.style.fontWeight = "bold";
                                const correctAnswerParagraph = document.createElement("p");
                                correctAnswerParagraph.innerHTML =
                                    "Correct Answer: " + correctAnswer;
                                correctAnswerParagraph.style.color = "green";
                                correctAnswerParagraph.style.fontWeight = "bold";
                                questionDiv.appendChild(correctAnswerParagraph);
                            } else {
                                feedbackParagraph.style.color = "red";
                                feedbackParagraph.style.fontWeight = "bold";

                                const correctAnswerParagraph = document.createElement("p");
                                correctAnswerParagraph.innerHTML =
                                    "Correct Answer: " + correctAnswer;
                                correctAnswerParagraph.style.color = "green";
                                correctAnswerParagraph.style.fontWeight = "bold";
                                questionDiv.appendChild(correctAnswerParagraph);
                            }

                            questionDiv.appendChild(feedbackParagraph);
                            feedbackContainer.appendChild(questionDiv);
                        } else {
                            const optionLabel = document.createElement("label");
                            const optionInput = document.createElement("input");
                            optionInput.type = "radio";
                            optionInput.disabled = true;

                            if (option[0] === q.answer) {
                                optionInput.checked = true;
                                optionLabel.style.color = "green";
                                optionLabel.style.fontWeight = "bold";
                            } else if (option[0] === userAnswers[questionIndex]) {
                                optionInput.checked = true;
                                optionLabel.style.color = "red";
                                questionTitle.style.fontWeight = "bold";
                            }

                            optionLabel.appendChild(optionInput);
                            optionLabel.appendChild(document.createTextNode(option));
                            questionDiv.appendChild(optionLabel);
                            questionDiv.appendChild(document.createElement("br"));
                        }
                        feedbackContainer.appendChild(questionDiv);
                    });
                });

            document.getElementById("feedbackNextButton").disabled =
                currentQuestion === selectedQuestions.length - 1;
        }

        function nextFeedback() {
            if (currentQuestion < selectedQuestions.length - 1) {
                currentQuestion++;
                displayFeedback();
            }
        }

        function previousFeedback() {
            if (currentQuestion > 0) {
                currentQuestion--;
                displayFeedback();
            }
        }

        function resetQuiz() {
            const confirmRetake = confirm("Reset current Quiz?");
            if (confirmRetake) {
                currentQuestion = 0;
                userAnswers.fill("");
                document.getElementById("feedbackContainer").style.display = "none";
                retake.style.display = "none";
                resultDiv.style.display = "none";
                userScore.style.display = "none";
                resultDiv2.style.display = "none";
                scoreContainer.style.display = "none";
                document.getElementById("quizContainer").style.display = "block";
                showQuestion(currentQuestion);
            } else {
                return;
            }
        }

        function disableResetAfterCheckboxPress() {
            resetBtn.disabled = true;
            setTimeout(() => {
                resetBtn.disabled = false;
            }, 400);
        }

        function retakeQuiz() {
            const confirmRetake = confirm("Retake Quiz?");
            if (confirmRetake) {
                currentQuestion = 0;
                userAnswers.fill("");
                document.getElementById("feedbackContainer").style.display = "none";
                retake.style.display = "none";
                resultDiv.style.display = "none";
                userScore.style.display = "none";
                resultDiv2.style.display = "none";
                scoreContainer.style.display = "none";
                document.getElementById("quizContainer").style.display = "block";
                showQuestion(currentQuestion);
            } else {
                return;
            }
        }

        const radioButtons = document.querySelectorAll('input[name="quizType"]');
        radioButtons.forEach((radioButton) => {
            radioButton.addEventListener("change", () => {
                quizType = radioButton.value;
                lectureSelectionDiv.style.display =
                    quizType === "custom" ? "block" : "none";
                updateQuiz();
            });
        });

        function showLectureSelection() {
            const confirmShow = confirm(
                "Do you want to manually select lectures to be quizzed on?"
            );
            if (confirmShow) {
                document.getElementById("lectureSelectionDialog").style.display = "flex";
                generateLectureSelection();
            } else {
                return;
            }
        }

        function generateLectureSelection() {
            const lectureCheckboxes = document.getElementById("lectureCheckboxes");
            lectureCheckboxes.innerHTML = "";

            lectureRanges.forEach((lectureRange, index) => {
                const label = document.createElement("label");
                label.innerHTML = `
                <input type="checkbox" name="lectureCheckbox" value="${index + 1
                    }"> ${lectureRange.name}
            `;
                lectureCheckboxes.appendChild(label);
            });
        }

        function startSelectedLectures() {
            const selectedLectureNumbers = Array.from(
                document.querySelectorAll('input[name="lectureCheckbox"]:checked')
            ).map((checkbox) => parseInt(checkbox.value));

            if (selectedLectureNumbers.length === 0) {
                alert("Please select at least one lecture.");
                return;
            }

            selectedQuestions = [];
            selectedLectureNumbers.forEach((lectureNumber) => {
                const lectureRange = getLectureRangeByNumber(lectureNumber);
                for (let i = lectureRange.start; i <= lectureRange.end; i++) {
                    selectedQuestions.push(i);
                }
            });

            document.getElementById("lectureSelectionDialog").style.display = "none";
            currentQuestion = 0;

            localStorage.setItem("userAnswers", userAnswers.fill(""));

            updateQuestionCount();
            saveProgressLocally();
            showQuestion(currentQuestion);
        }

    </script>
</body>

</html>